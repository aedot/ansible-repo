{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "extends": [
    "config:base"
  ],

  "ansible": {
    "fileMatch": [
      "(^|/)tasks/[^/]+\\.ya?ml$"
    ]
  },

  "dependencyDashboard": true,
  "dependencyDashboardAutoclose": true,

  "rebaseWhen": "behind-base-branch",
    "timezone": "America/Los_Angeles",
    "schedule": [
      "at any time"
    ],
    "reviewers": ["aedot"],
    "assignees": ["aedot"],
  
    "commitMessagePrefix": "{{depName}}:",
    "commitMessageAction": "Update",
    "commitMessageTopic": "dependency {{depName}}",
    "commitMessageExtra": "to {{#if isPinDigest}}{{{newDigestShort}}}{{else}}{{#if isMajor}}{{prettyNewMajor}}{{else}}{{#if isSingleVersion}}{{prettyNewVersion}}{{else}}{{#if newValue}}{{{newValue}}}{{else}}{{{newDigestShort}}}{{/if}}{{/if}}{{/if}}{{/if}}",


  "packageRules": [
    {
      "description": "Automatically merges minor and patch-level updates",
      "matchUpdateTypes": ["minor", "patch", "digest"],
      "automerge": true,
      "automergeType": "branch"
    },

    {
      "description": "Automatically creates a PR whenever there is a new major Renovate version",
      "matchUpdateTypes": ["major"],
      "automerge": false,
      "prCreation": "immediate"
    },
    
    {
      "matchDatasources": ["docker"],
      "matchUpdateTypes": ["major"],
      "enabled": true
    },

    {
      "matchPaths": ["playbooks/apps/*.yml"],
      "matchPackageTypes": ["docker"],
      "commitMessageTopic": "chore(deps): update Docker images in Ansible playbook"
    },

    {
      "matchPackagePatterns": [".*\\/actual-server"],
      "customChangelogUrl": "https://github.com/actualbudget/actual-server",
      "prBodyNotes": "[releases.md](https://github.com/actualbudget/docs/blob/master/docs/releases.md)",
      }
    ]
}
