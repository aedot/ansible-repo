{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",

  "rebaseWhen": "conflicted",

  "major": {
    "dependencyDashboardApproval": true
  },

  "minor": {
    "automerge": true
  },
  "patch": {
    "automerge": true
  },
  "pin": {
    "automerge": true
  },

  "ansible": {
    "fileMatch": [
      "(^|/)tasks/[^/]+\\.ya?ml$"
    ]
  },

  "timezone": "America/Los_Angeles",

  "schedule": [
    "at any time"
  ],

  "reviewers": ["aedot"],

  "commitMessagePrefix": "{{depName}}:",
  "commitMessageAction": "Update",
  "commitMessageTopic": "version",
  "commitMessageExtra": "to {{#if isPinDigest}}{{{newDigestShort}}}{{else}}{{#if isMajor}}{{prettyNewMajor}}{{else}}{{#if isSingleVersion}}{{prettyNewVersion}}{{else}}{{#if newValue}}{{{newValue}}}{{else}}{{{newDigestShort}}}{{/if}}{{/if}}{{/if}}{{/if}}",

  /*
    Renovate will evaluate all packageRules and not stop once it gets a first match
    You should order your packageRules in order of importance so that later rules can override settings from earlier rules if needed.
  */
  
  "packageRules": [
    /* Ignore latest and localhost tags */
    // {
    //   "matchDatasources": ["docker"],
    //   "matchCurrentVersion": "/localhost|latest/"
    // },
    /*
      uses Docker datasource defaults
      https://docs.renovatebot.com/modules/datasource/#docker-datasource
    */
    {
      "matchDepTypes": ["docker"],
      "matchUpdateTypes": ["pin"],
      "commitMessageTopic": "{{{depName}}} Docker tag",
      "commitMessageExtra": "to {{#if isPinDigest}}{{{newDigestShort}}}{{else}}{{#if isMajor}}{{{prettyNewMajor}}}{{else}}{{{prettyNewVersion}}}{{/if}}{{/if}}",
      "digest": {
        "branchTopic": "{{{depNameSanitized}}}-{{{currentValue}}}",
        "commitMessageExtra": "to {{newDigestShort}}",
        "commitMessageTopic": "{{{depName}}}{{#if currentValue}}:{{{currentValue}}}{{/if}} Docker digest",
        "group": {
          "commitMessageTopic": "{{{groupName}}}",
          "commitMessageExtra": ""
        }
      },
      "pin": {
        "commitMessageExtra": "",
        "groupName": "Docker digests",
        "group": {
          "commitMessageTopic": "{{{groupName}}}",
          "branchTopic": "digests-pin"
        }
      }
    }
  
  ],

  "prBodyTemplate": "{{{header}}}{{{table}}}{{{warnings}}}{{{notes}}}{{{changelogs}}}{{{configDescription}}}{{{controls}}}{{{footer}}}"
}
