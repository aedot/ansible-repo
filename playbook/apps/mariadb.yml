---

- hosts: 

  vars:
    application: mariadb
    docker_network: 

    mysql_root_password: !vault |
      $ANSIBLE_VAULT;1.1;AES256
      39383661383430363537646630633938376637616132643630346335643732333032643566383161
      3263613537303264623539636234323031636363633038340a626365623166313439653564613636
      34323562623466313064386631346361653738653064306366653438663737303862353465356139
      3263393865343339320a633765363164336532633364336163383133333166343764326534666233
      30626263383539383661613237616166386537646434633632383762373264663365643564303632
      3931323330323966326163333235346136383338666637613461

    mysql_root_user: !vault |
      $ANSIBLE_VAULT;1.1;AES256
      32346462616165373765313833656439666130623661323862396331666464633338613862386639
      3530663231663666393262633530346331666130626265380a646566343734616464616261333164
      31623534346535646663386530303864326630663134626431323739326636636434323438643061
      6435353264643332360a336634643739326235343362356161663930656565313537356137333934
      6130

    mysql_password: !vault |
      $ANSIBLE_VAULT;1.1;AES256
      35663439633832313336623439646534623837643635396366636331653233626362626431333933
      3034386662373534306339646165613863316665353832650a313366376661653165396639663830
      30616634386438353635303835656632303734376431373164363937636464666662303039363834
      6466666662356234300a303238666463396663623733343031623563633664333138346438353961
      37663034626336376636383765386531303261656434343164353939633261333764626463353862
      3538363663633465653632303062373331363235663638383266


  tasks:
    - name: Create config folder
      ansible.builtin.file:
        path: "{{ config_directory }}"
        state: directory
        owner: "{{ common_user }}"
        group: "{{ common_group }}"
        mode: "0775"

    - name: Create container
      community.docker.docker_container:
        name: "{{ application }}"
        image: linuxserver/mariadb:10.11.6
        state: started
        restart_policy: unless-stopped
        published_ports:
          - 3306:3306
        volumes:
          - "{{ config_directory }}:/config"
        env:
          TZ: "{{ common_timezone }}"
          MYSQL_ROOT_PASSWORD: "{{ mysql_root_password }}"
          MYSQL_ROOT_USER: "{{ mysql_root_user }}"
        networks: 
          - name: "{{ docker_network }}"